<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Kalkulator Metabolisme & Estimasi Diet</title>

    <!-- MathJax -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- CSS External -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- ========================== HEADER ========================== -->
    <header class="topbar">
        <div class="left">
            <img src="logo.jpg" alt="Logo Kampus">
            <div>
                <div class="group">Turunan â€“ Kelompok 1</div>
                <div class="course">Kalkulus Diferensial</div>
            </div>
        </div>

        <div class="social">
            <a href="https://instagram.com/jlvnnw" target="_blank" class="instagram">
                <i class="fab fa-instagram"></i>
            </a>
            <a href="https://wa.me/6281274330984" target="_blank" class="whatsapp">
                <i class="fab fa-whatsapp"></i>
            </a>
            <a href="mailto:julvinrnwaruwu@gmail.com?subject=Pertanyaan&body=Halo..." class="email">
                <i class="fas fa-envelope"></i>
            </a>
        </div>
    </header>

    <!-- ========================== HERO ========================== -->
    <header class="hero">
        <div class="hero-inner">
            <h1>Kalkulator Metabolisme & Estimasi Diet</h1>
            <p class="sub">Analisis & prediksi estimasi kalori selama 7 hari serta Berat 30 hari.</p>

            <!-- Menu -->
            <div class="feature-box">
                <div class="card-menu" data-open="panel-theory">
                    <span class="icon">ğŸ ï¸</span> <span>Teori & Rumus</span>
                </div>
                <div class="card-menu" data-open="panel-usage">
                    <span class="icon">ğŸ“„</span> <span>Cara Penggunaan</span>
                </div>
                <div class="card-menu active" data-open="panel-test">
                    <span class="icon">ğŸ“</span> <span>Calorie Calculator</span>
                </div>
            </div>
        </div>
    </header>

    <!-- ========================== MAIN ========================== -->
    <main class="container">

        <!-- ==================== PANEL 1: TEORI ==================== -->
        <section id="panel-theory" class="panel">
            <h2>ğŸ ï¸ Teori & Rumus</h2>

            <div class="panel-grid">

                <!-- Card 1 -->
                <article class="card">
                    <h3>Landasan Teori</h3>

                    <p><b>BMR</b> adalah jumlah energi minimum yang diperlukan tubuh untuk 
                        mempertahankan fungsi vital saat istirahat. Rumus ini mepertimbangkan
                        berat badan, tinggi badan, usia, dan jenis kelamin.</p>
                    <p><b>TDEE</b> adalah total energi harian yang dikeluarkan tubuh termasuk
                        aktivitas fisik. Nilai ini digunakan menentukan kebutuhan kalori untuk
                        menjaga, menaikkan, atau menurunkan berat badan.</p>
                    <p><b>Selisih Kalori<b> digunakan untuk melihat apakah tubuh berada dalam kondisi
                    defisit (turun berat) atau surplus (naik berat).</p>

                    <p>ğŸ“Š Grafik Kalori membantu memonitor:</p>
                    <ul>
                        <li>Surplus kalori â†’ potensi naik berat</li>
                        <li>Defisit kalori â†’ potensi turun berat</li>
                        <li>Seimbang â†’ berat stabil</li>
                    </ul>

                    <p>ğŸ“… Grafik Tren 30 Hari memberi gambaran jangka panjang pola diet.</p>
                </article>

                <!-- Card 2 -->
                <article class="card">
                    <h2>Rumus BMR â€“ TDEE â€“ Selisih</h2>

                    <h3>1. Rumus BMR (Mifflinâ€“St Jeor)</h3>
                    <p>Pria:</p>
                    <p class="rumus">\[ BMR = (10Ã—berat)+(6.25Ã—tinggi)-(5Ã—usia)+5 \]</p>

                    <p>Wanita:</p>
                    <p class="rumus">\[ BMR = (10Ã—berat)+(6.25Ã—tinggi)-(5Ã—usia)-161 \]</p>

                    <h3>2. Rumus TDEE</h3>
                    <p>\[ TDEE = BMR Ã— Faktor\ Aktivitas \]</p>

                    <h3>3. Selisih Kalori</h3>
                    <p>\[ Selisih = Intake - TDEE \]</p>
                </article>

                <!-- Card 3 -->
                <article class="card">
                    <h3>Landasan Teori Kalkulus</h3>

                    <p>\[ \frac{dW}{dt} = k (C_{in} - C_{out}) \]</p>

                    <p>\[ Î”E = \int_0^T (C_{in} - TDEE)\, dt \]</p>
                </article>
            </div>
        </section>

        <!-- ==================== PANEL 2: CARA PAKAI ==================== -->
        <section id="panel-usage" class="panel">
            <h2>Cara Penggunaan</h2>
            <p>Kalkulator ini menghitung BMR, TDEE dan memberi rekomendasi diet.</p>

            <div class="usage-steps">
                <div class="step"><span class="num">1</span><h3>Masukkan Data</h3></div>
                <div class="step"><span class="num">2</span><h3>Pilih Aktivitas</h3></div>
                <div class="step"><span class="num">3</span><h3>Klik Hitung</h3></div>
                <div class="step"><span class="num">4</span><h3>Lihat Hasil</h3></div>
            </div>
        </section>

        <!-- ==================== PANEL 3: FORM ==================== -->
        <section id="panel-test" class="panel active">
            <h2>Form Input & Tes</h2>

            <div class="grid-2">

                <!-- Form -->
                <div class="card form-card">
                    <h3>Input</h3>

                    <div class="row">
                        <div class="label-box">Berat (kg)</div>
                        <input id="weight" type="number" class="input-box">
                    </div>

                    <div class="row">
                        <div class="label-box">Tinggi (cm)</div>
                        <input id="height" type="number" class="input-box">
                    </div>

                    <div class="row">
                        <div class="label-box">Usia</div>
                        <input id="age" type="number" class="input-box">
                    </div>

                    <div class="row">
                        <div class="label-box">Jenis Kelamin</div>
                        <select id="gender" class="input-box">
                            <option value="male">Laki-laki</option>
                            <option value="female">Perempuan</option>
                        </select>
                    </div>

                    <div class="row">
                        <div class="label-box">Aktivitas</div>
                        <select id="activity" class="input-box">
                            <option value="1.2">Tidak Aktif</option>
                            <option value="1.375">Ringan</option>
                            <option value="1.55">Sedang</option>
                            <option value="1.725">Berat</option>
                            <option value="1.9">Atlet</option>
                        </select>
                    </div>

                    <div class="row">
                        <div class="label-box">Kalori / hari</div>
                        <input id="calorie" type="number" class="input-box">
                    </div>

                    <div class="row">
                        <div class="label-box">Tujuan</div>
                        <select id="goal" class="input-box">
                            <option value="cutting">Diet</option>
                            <option value="bulking">Bulking</option>
                        </select>
                    </div>

                    <div class="result-box">
                        <div><strong>BMR (Basal Metabolic Rate):</strong> <span id="bmrValue">â€”</span> kCal</div>
                        <div><strong>TDEE (Total Daily Energy Expenditure):</strong> <span id="tdeeValue">â€”</span> kCal</div>
                        <div><strong>Selisih kalori:</strong> <span id="diffValue">â€”</span> kCal</div>
                    </div>

                    <div class="actions">
                        <button id="calcBtn" class="btn primary">Hitung</button>
                        <button id="resetBtn" class="btn ghost">Reset</button>
                    </div>
                </div>

                <!-- Info -->
                <aside class="card info-card">
                    <h3>Kalori Makanan</h3>
                    <ul class="food-list">
                        <li>Nasi 100g : 130 kCal</li>
                        <li>Dada ayam 100g : 165 kCal</li>
                        <li>Sayur 100g : 25 kCal</li>
                    </ul>

                    <h4>Grafik</h4>
                    <button class="btn" data-open="panel-graphs">Buka Grafik</button>
                </aside>

            </div>
        </section>

        <!-- ==================== PANEL 4: GRAFIK ==================== -->
        <section id="panel-graphs" class="panel">
            <h2>Grafik</h2>

            <div class="chart-grid">
                <div class="chart-card">
                    <h3>Estimasi Kalori (7 Hari)</h3>
                    <canvas id="kaloriChart"></canvas>
                </div>

                <div class="chart-card">
                    <h3>Prediksi Berat (30 Hari)</h3>
                    <canvas id="weightChart"></canvas>
                </div>
            </div>
        </section>

    </main>

    <!-- ========================== FOOTER ========================== -->
    <footer class="footer">
        <small>Proyek Kelompok 1 PSIK 25D</small>
    </footer>

    <!-- ========================== JAVASCRIPT ========================== -->
    <script>
        /* Semua script yang kamu kirim dimasukkan di sini TANPA mengubah logika */

        /* â€”â€”â€”â€”â€”â€”â€”â€”â€” Utility â€”â€”â€”â€”â€”â€”â€”â€”â€” */
const qs = v => document.querySelector(v);
const qsa = v => document.querySelectorAll(v);

let kaloriChart = null;
let weightChart = null;

/* Element DOM */
const panels = qsa('.panel');
const openButtons = qsa('[data-open]');

const weightInput = qs('#weight');
const heightInput = qs('#height');
const ageInput = qs('#age');
const genderInput = qs('#gender');
const activityInput = qs('#activity');
const calorieInput = qs('#calorie');
const goalInput = qs('#goal');

const bmrDisplay = qs('#bmrValue');
const tdeeDisplay = qs('#tdeeValue');
const diffDisplay = qs('#diffValue');

const calcBtn = qs('#calcBtn');
const resetBtn = qs('#resetBtn');

/* â€”â€”â€”â€”â€”â€”â€”â€”â€” Panel open â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function openPanel(id) {
    panels.forEach(p => p.classList.remove('active'));
    qs('#' + id).classList.add('active');

    if (id === "panel-graphs") {
        initOrUpdateCharts();
    }
}

openButtons.forEach(btn =>
    btn.addEventListener('click', () => openPanel(btn.dataset.open))
);

/* â€”â€”â€”â€”â€”â€”â€”â€”â€” BMR Calc â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function calcBMR(w, h, a, gender) {
    if (!w || !h || !a) return 0;

    if (gender === "male") {
        return (10 * w) + (6.25 * h) - (5 * a) + 5;
    } else {
        return (10 * w) + (6.25 * h) - (5 * a) - 161;
    }
}

function animateValue(el, start, end, duration = 600) {
    const range = end - start;
    const startTime = performance.now();

    function step(now) {
        const progress = Math.min((now - startTime) / duration, 1);
        el.textContent = Math.round(start + range * progress);
        if (progress < 1) requestAnimationFrame(step);
    }
    requestAnimationFrame(step);
}


/* â€”â€”â€”â€”â€”â€”â€”â€”â€” Grafik Data â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function genKalori7days(tdee) {
    return Array(7).fill(Math.round(tdee));
}

function genWeight30days(initialWeight, diff) {
    const arr = [];
    let w = Number(initialWeight);
    const kgPerDay = diff / 7700; // 7700 kCal = 1 kg

    for (let i = 0; i < 30; i++) {
        w += kgPerDay;
        arr.push(Number(w.toFixed(1)));
    }
    return arr;
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€” Update Grafik â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function initOrUpdateCharts() {

    const w = Number(weightInput.value);
    const h = Number(heightInput.value);
    const a = Number(ageInput.value);
    const g = genderInput.value;
    const ac = Number(activityInput.value);
    const intake = Number(calorieInput.value);

    const bmr = calcBMR(w, h, a, g);
    const tdee = bmr * ac;
    const diff = Math.round(intake - tdee);

    // Update display animasi
    animateValue(bmrDisplay, Number(bmrDisplay.textContent) || 0, Math.round(bmr));
    animateValue(tdeeDisplay, Number(tdeeDisplay.textContent) || 0, Math.round(tdee));
    animateValue(diffDisplay, Number(diffDisplay.textContent) || 0, diff);

    const kaloriData = genKalori7days(tdee);
    const weightData = genWeight30days(w, diff);

    const kaloriCtx = qs('#kaloriChart').getContext('2d');
    const weightCtx = qs('#weightChart').getContext('2d');

    // Chart Kalori
    if (kaloriChart) {
        kaloriChart.data.datasets[0].data = kaloriData;
        kaloriChart.update();
    } else {
        kaloriChart = new Chart(kaloriCtx, {
            type: 'line',
            data: {
                labels: ["Hari 1","Hari 2","Hari 3","Hari 4","Hari 5","Hari 6","Hari 7"],
                datasets: [{
                    label: "Estimasi Kalori Terbakar",
                    data: kaloriData,
                    borderColor: "#4aa2e9",
                    backgroundColor: "rgba(74,162,233,0.12)",
                    tension: 0.4,
                    fill: true
                }]
            }
        });
    }

    // Chart Berat
    if (weightChart) {
        weightChart.data.datasets[0].data = weightData;
        weightChart.update();
    } else {
        weightChart = new Chart(weightCtx, {
            type: 'line',
            data: {
                labels: Array.from({ length: 30 }, (_, i) => `Hari ${i + 1}`),
                datasets: [{
                    label: "Prediksi Berat (kg)",
                    data: weightData,
                    borderColor: "#ffd166",
                    backgroundColor: "rgba(255,209,102,0.06)",
                    tension: 0.35,
                    fill: true
                }]
            }
        });
    }
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€” Event â€”â€”â€”â€”â€”â€”â€”â€”â€” */
calcBtn.addEventListener("click", () => {
    openPanel("panel-graphs");
    initOrUpdateCharts();
});

resetBtn.addEventListener("click", () => {
    weightInput.value = "";
    heightInput.value = "";
    ageInput.value = "";
    calorieInput.value = "";
    genderInput.value = "male";
    activityInput.value = "1.2";

    animateValue(bmrDisplay, Number(bmrDisplay.textContent) || 0, 0);
    animateValue(tdeeDisplay, Number(tdeeDisplay.textContent) || 0, 0);
    animateValue(diffDisplay, Number(diffDisplay.textContent) || 0, 0);

    if (qs('#panel-graphs').classList.contains('active')) {
        initOrUpdateCharts();
    }
});

window.addEventListener("load", () => openPanel("panel-test"));

    </script>

</body>
</html>







